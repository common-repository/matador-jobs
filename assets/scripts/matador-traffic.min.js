"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,a,n=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(n.push(i.value),!t||n.length!==t);s=!0);}catch(e){o=!0,a=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw a}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,n=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw n}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var MatadorTraffic=function(){function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"{}";_classCallCheck(this,e),this.domain=t,this.options=JSON.parse(r),this.referrer=document.referrer,this.defaults={host:this.domain,cookieName:"matador_visitor",separator:".",expires:1728e5,labels:{none:"direct(none)",social:"social",referral:"referral",organic:"organic"},queryParams:{campaign:"utm_campaign",source:"utm_source",medium:"utm_medium",term:"utm_term",content:"utm_content"},socialNetworks:{facebook:["/(.+?).facebook./","/(.+?).fb.me/"],linkedin:["/(.+?).linkedin./"],twitter:["/(.+?).twitter./","/(.+?).t.co/"],reddit:["/(.+?).reddit./"],instagram:["/(.+?).instagram./"],youtube:["/(.+?).youtube./"]},searchEngines:{google:["/(.+?).google./"],bing:["/(.+?).bing./"],yahoo:["/(.+?).yahoo./"],aol:["/(.+?).aol./"],baidu:["/(.+?).baidu./"],duckduckgo:["/(.+?).duckduckgo./"]}},this.options=Object.assign(this.defaults,this.options),this.campaign={timestamp:"",sessions:1,campaigns:0,campaign:"",medium:"",source:"",term:"",content:""},this.initialize()}return _createClass(e,[{key:"query",get:function(){var e={};return e.campaign=this.queryParameter(this.options.queryParams.campaign),e.source=this.queryParameter(this.options.queryParams.source),e.medium=this.queryParameter(this.options.queryParams.medium),e.term=this.queryParameter(this.options.queryParams.term),e.content=this.queryParameter(this.options.queryParams.content),e}},{key:"initialize",value:function(){var t;this.hasReferrer()&&(this.hasCookie(this.options.cookieName)?(t=this.getCookie(this.options.cookieName),this.parseMatadorCookie(t)):this.hasCookie("__utmz")&&(t=this.getCookie("__utmz"),this.parseUTMZCookie(t)),this.query.campaign||this.query.source?this.query.campaign&&this.query.campaign===this.campaign.campaign||this.query.source&&this.query.source===this.campaign.campaign?this.campaign.sessions++:(this.campaign.campaign=this.query.campaign?this.query.campaign:this.query.source,this.query.source&&this.query.source!==this.campaign.source?this.campaign.source=this.query.source:this.campaign.source="",this.query.medium&&this.query.medium!==this.campaign.medium?this.campaign.medium=this.query.medium:this.campaign.medium="",this.query.content&&this.query.content!==this.campaign.content?this.campaign.content=this.query.content:this.campaign.content="",this.query.term&&this.query.term!==this.campaign.term?this.campaign.term=this.query.term:this.campaign.term="",this.campaign.sessions=1,this.campaign.campaigns++):this.referrer?this.campaign.source===e.removeProtocol(this.referrer)?this.campaign.sessions++:(this.campaign.campaign="",this.campaign.source=e.removeProtocol(this.referrer),this.referrerIsA(this.options.socialNetworks)?(this.campaign.source=this.referrerIsA(this.options.socialNetworks),this.campaign.medium=this.options.labels.social):this.referrerIsA(this.options.searchEngines)?(this.campaign.source=this.referrerIsA(this.options.searchEngines),this.campaign.medium=this.options.labels.organic):this.campaign.medium=this.options.labels.referral,this.campaign.term="",this.campaign.content="",this.campaign.sessions=1,this.campaign.campaigns++):this.campaign.source===this.options.labels.none?this.campaign.sessions++:(this.campaign.source=this.options.labels.none,this.campaign.campaign="",this.campaign.medium="",this.campaign.term="",this.campaign.content="",this.campaign.sessions=1,this.campaign.campaigns++),this.setCookie())}},{key:"queryParameter",value:function(e){var t,r,i,a=_createForOfIteratorHelper(window.location.search.substring(1).split("&"));try{for(a.s();!(i=a.n()).done;){var n=_slicedToArray(i.value.split("="),2);t=n[0];var s=n[1];if(r=void 0===s?"":s,t===e)break;r=""}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"hasCookie",value:function(e){return-1!==document.cookie.indexOf(e)}},{key:"getCookie",value:function(e){var t,r,i=_createForOfIteratorHelper(document.cookie.split("; "));try{for(i.s();!(r=i.n()).done;){var a=_slicedToArray(r.value.split(/=(.+)/),2);t=a[0];var n=a[1];if(t===e)return void 0===n?"":n}}catch(e){i.e(e)}finally{i.f()}return null}},{key:"setCookie",value:function(){var e,t,r,i=new Date,a=this.campaign,n=this.options;for(e in a.timestamp=Math.floor(i.getTime()/1e3),i.setTime(i.getTime()+n.expires),r="".concat(a.timestamp).concat(n.separator).concat(a.sessions).concat(n.separator).concat(a.campaigns),delete a.timestamp,delete a.sessions,delete a.campaigns,t="",a)a[e]&&(t+=t?"|":"",t+="".concat(e,"=").concat(a[e]));r+="".concat(n.separator).concat(t),document.cookie=n.cookieName+"="+r.replace(/ /g,"_")+"; expires="+i.toUTCString()+"; domain="+this.domain+"; path=/; samesite=strict; "}},{key:"hasReferrer",value:function(){return this.referrer.split("/")[2]!==location.hostname}},{key:"referrerIsA",value:function(e){var t,r,i,a=0<arguments.length&&void 0!==e?e:{},n="";if(0===Object.keys(a).length&&a.constructor===Object)return!1;for(r in a){var s,o=_createForOfIteratorHelper(a[r]);try{for(o.s();!(s=o.n()).done;)if(i=s.value,t=new RegExp(i.slice(1,-1)),this.referrer.match(t)){n=r;break}}catch(e){o.e(e)}finally{o.f()}if(n)break}return n}},{key:"parseMatadorCookie",value:function(e){var t,r;t=e.split(".",4),this.campaign.timestamp=t[0],this.campaign.sessions=parseInt(t[1],10),this.campaign.campaigns=parseInt(t[2],10);var i,a=_createForOfIteratorHelper(t[3].split("|"));try{for(a.s();!(i=a.n()).done;)r=i.value.split("="),this.campaign[r[0]]=r[1]}catch(e){a.e(e)}finally{a.f()}}},{key:"parseUTMZCookie",value:function(e){var t,r,i;t={utmccn:"campaign",utmcmd:"medium",utmcsr:"source",utmctr:"term",utmcct:"content"},r=e.split(".",5),this.campaign.timestamp=r[1],this.campaign.sessions=parseInt(r[2],10),this.campaign.campaigns=parseInt(r[3]);var a,n=_createForOfIteratorHelper(r[4].split("|"));try{for(n.s();!(a=n.n()).done;)i=a.value.split("="),this.campaign[t[i[0]]]=i[1]}catch(e){n.e(e)}finally{n.f()}}}],[{key:"removeProtocol",value:function(e){return e.replace(/.*?:\/\//g,"")}}]),e}();